<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸²ç‡’é»é¤ç³»çµ±  </title>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>emailjs.init("7IZOtgPZQ7wPzRUOx");</script>

<style>
body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin:0; padding:20px; background:#fffdf7; color:#333; }
h1 { text-align:center; color:#d35400; margin-bottom:20px; }
.menu { display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:15px; max-width:1000px; margin:0 auto; }
.menu-item { background:#fff; padding:10px; border-radius:12px; box-shadow:0 2px 6px rgba(0,0,0,0.1); text-align:center; }
.menu-item img { width:120px; height:120px; object-fit:cover; border-radius:10px; margin-bottom:5px; }
.menu-item label { display:block; font-weight:bold; margin-bottom:5px; }
.menu-item .qty-controls { display:flex; justify-content:center; align-items:center; gap:10px; margin-bottom:5px; }
.menu-item button { width:30px; height:30px; font-size:18px; cursor:pointer; }
.menu-item span { min-width:30px; display:inline-block; text-align:center; font-weight:bold; }
button#submitOrder { display:block; margin:30px auto; padding:12px 30px; background:#e67e22; border:none; border-radius:8px; color:#fff; font-size:18px; font-weight:bold; cursor:pointer; transition: background 0.3s; }
button#submitOrder:hover { background:#d35400; }
#orderResult { display:flex; justify-content:center; margin-top:20px; }
.ticket { border:3px dashed #333; padding:20px; text-align:center; background:#fff; border-radius:15px; width:300px; box-shadow:0 4px 8px rgba(0,0,0,0.1); }
.ticket h2 { margin:0; font-size:60px; color:#e60000; }
.ticket p { margin:8px 0; font-size:18px; }
.ticket p.notice { color:#888; font-size:14px; }
</style>
</head>
<body>

<h1>ğŸ¢ æ²–å¤©ç‚®é»é¤ç³»çµ±</h1>

<form id="orderForm">
<div class="menu" id="menuContainer">
  <!-- é¤é»åˆ—è¡¨æœƒç”¨ JS ç”Ÿæˆ -->
</div>

<button type="submit" id="submitOrder">é€å‡ºè¨‚å–®</button>
</form>

<div id="orderResult"></div>

<script>
let orderNumber = 1;

// é¤é»è³‡æ–™ï¼ˆåç¨±ã€åƒ¹æ ¼ã€åœ–ç‰‡ï¼‰
const menuData = [
  {name:"ç‰›è‚‰ä¸²", price:30, img:"https://i.imgur.com/5eJq2Fs.jpg"},
  {name:"ç¾Šè‚‰ä¸²", price:30, img:"https://i.imgur.com/NkTzL2d.jpg"},
  {name:"è±¬è‚‰ä¸²", price:30, img:"https://i.imgur.com/x70qYeh.jpg"},
  {name:"é›è‚‰ä¸²", price:30, img:"https://i.imgur.com/fbT2qLK.jpg"},
  {name:"é¦™è”¥é›è…¿è‚‰ä¸²", price:50, img:"https://i.imgur.com/0LUKQd2.jpg"},
  {name:"é»‘è±¬è‚‰é¦™è…¸", price:40, img:"https://i.imgur.com/igkMRt3.jpg"},
  {name:"ä¸ƒé‡Œé¦™", price:40, img:"https://i.imgur.com/P2Zcg2i.jpg"},
  {name:"é¦™é…¥è±†çš®", price:30, img:"https://i.imgur.com/8Rg7V5y.jpg"},
  {name:"å¤æ—©å‘³ç”œä¸è¾£", price:30, img:"https://i.imgur.com/3gWqFxF.jpg"}
];

const prices = {};
menuData.forEach(item => prices[item.name]=item.price);

// ç”Ÿæˆèœå–® HTML
const menuContainer = document.getElementById("menuContainer");
menuData.forEach(item=>{
  const div = document.createElement("div");
  div.className="menu-item";
  div.innerHTML = `
    <img src="${item.img}" alt="${item.name}">
    <label>${item.name} - ${item.price}å…ƒ/ä¸²</label>
    <div class="qty-controls">
      <button type="button" class="minus">-</button>
      <span class="qty">0</span>
      <button type="button" class="plus">+</button>
    </div>
  `;
  menuContainer.appendChild(div);

  const minusBtn = div.querySelector(".minus");
  const plusBtn = div.querySelector(".plus");
  const qtySpan = div.querySelector(".qty");

  minusBtn.addEventListener("click",()=>{ let n=parseInt(qtySpan.textContent); if(n>0) qtySpan.textContent=n-1; });
  plusBtn.addEventListener("click",()=>{ let n=parseInt(qtySpan.textContent); qtySpan.textContent=n+1; });
});

document.getElementById("orderForm").addEventListener("submit", function(e){
  e.preventDefault();

  let orderList = [];
  let bbqCount=0, sausageCount=0, otherCount=0, totalPrice=0;

  document.querySelectorAll(".menu-item").forEach(div=>{
    const name = div.querySelector("label").textContent.split(" - ")[0];
    const qty = parseInt(div.querySelector(".qty").textContent);
    for(let i=0;i<qty;i++) orderList.push(name);

    // çµ±è¨ˆ
    if(["ç‰›è‚‰ä¸²","ç¾Šè‚‰ä¸²","è±¬è‚‰ä¸²","é›è‚‰ä¸²"].includes(name)) bbqCount += qty;
    else if(["é»‘è±¬è‚‰é¦™è…¸","ä¸ƒé‡Œé¦™"].includes(name)) sausageCount += qty;
    else otherCount += qty;
  });

  // è¨ˆç®—ç¸½åƒ¹
  totalPrice += Math.floor(bbqCount/4)*100 + (bbqCount%4)*30;
  totalPrice += Math.floor(sausageCount/3)*110 + (sausageCount%3)*40;

  document.querySelectorAll(".menu-item").forEach(div=>{
    const name = div.querySelector("label").textContent.split(" - ")[0];
    if(["é¦™è”¥é›è…¿è‚‰ä¸²","é¦™é…¥è±†çš®","å¤æ—©å‘³ç”œä¸è¾£"].includes(name)){
      const qty = parseInt(div.querySelector(".qty").textContent);
      totalPrice += qty*prices[name];
    }
  });

  let currentOrder = orderNumber++;
  let ticketHTML = `<div class="ticket">
    <p>å–é¤è™Ÿç¢¼</p>
    <h2>${currentOrder}</h2>
    <p>é¤é»ï¼š${orderList.join(", ")}</p>
    <p>ç¸½åƒ¹ï¼š${totalPrice} å…ƒ</p>
    <p class="notice">ğŸ“¸ è«‹æˆªåœ–ä¿å­˜è™Ÿç¢¼ç‰Œ</p>
  </div>`;
  document.getElementById("orderResult").innerHTML = ticketHTML;

  // EmailJS
  emailjs.send("service_wpxmlac","template_oevsgt5",{order_number:currentOrder, order_list:orderList.join(", "), total_price:totalPrice})
    .then(response=>{console.log("âœ… è¨‚å–®å·²å¯„å‡º!"); alert("âœ… è¨‚å–®å·²é€å‡ºï¼åº—å®¶å·²æ”¶åˆ°æ‚¨çš„é»é¤");},
          error=>{console.error(error); alert("âŒ è¨‚å–®å¯„é€å¤±æ•—");});

  document.querySelectorAll(".menu-item .qty").forEach(span=>span.textContent="0");
});
</script>

</body>
</html>

